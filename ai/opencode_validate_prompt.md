# Opencode Validation Prompt

You are validating a FastAPI-based MCP redaction server.

Perform:

1. Security Audit
   - Regex safety
   - Thread safety
   - Predictable randomness
   - Memory growth
   - Mapping expiration
   - UUID handling

2. Production Improvements
   - Add rate limiting
   - Add logging middleware
   - Add input size enforcement
   - Add health endpoint
   - Add Dockerfile
   - Add CI pipeline

3. Refactor
   - Remove anti-patterns
   - Ensure SOLID principles
   - Add type hints everywhere
   - Add docstrings

Return:

- Updated full code
- New tests
- Security notes
- Production checklist